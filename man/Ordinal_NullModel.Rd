% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/null model.R
\name{Ordinal_NullModel}
\alias{Ordinal_NullModel}
\title{Fit Null Model for Ordinal Traits using Proportional Odds Model}
\usage{
Ordinal_NullModel(
  phenofile,
  ordCol,
  sampleCol,
  covCol = NULL,
  offsetCol = NULL,
  use_SPA = FALSE,
  range = c(-100, 100),
  length.out = 10000,
  verbose = FALSE
)
}
\arguments{
\item{phenofile}{A character string specifying the path to the phenotype file
(csv, tab-delimited, etc.) or a data frame containing the phenotype and covariates.}

\item{ordCol}{A character string specifying the column name of the ordinal phenotype.}

\item{sampleCol}{A character string specifying the column name of the sample IDs.}

\item{covCol}{A character vector specifying the column names of the covariates.
Default is \code{NULL}.}

\item{offsetCol}{A character string specifying the column name of an offset variable
(if any). Default is \code{NULL}.}

\item{use_SPA}{A logical indicating whether to prepare the object for Saddlepoint
Approximation (SPA) in downstream testing. Default is \code{FALSE}.}

\item{range}{A numeric vector of length 2. Reserved for future SPA parameter usage.
Default is \code{c(-100, 100)}.}

\item{length.out}{An integer. Reserved for future SPA parameter usage.
Default is \code{1e4}.}

\item{verbose}{A logical indicating whether to print progress messages.
Default is \code{FALSE}.}
}
\value{
An object of class \code{staar_nullmodel}. This is a list containing:
\item{scaled.residuals}{The score residuals adjusted for the covariance structure.}
\item{Sigma_i}{The inverse of the variance-covariance matrix (diagonal matrix).}
\item{covariance}{The covariance matrix of the model coefficients.}
\item{coefficients}{The estimated coefficients from the proportional odds model.}
\item{linear.predictors}{The linear predictors of the model.}
\item{fitted.values}{Fitted values (on the latent scale).}
\item{residuals}{Working residuals.}
\item{id_include}{Vector of sample IDs included in the analysis.}
\item{...}{Other internal parameters for STAAR functions.}
}
\description{
This function fits a null model for ordinal traits in preparation for
rare variant association testing using the STAAR framework. It uses the
proportional odds model (via \code{\link[MASS]{polr}}) to estimate
parameters and calculates the score residuals and covariance matrix
required for downstream analysis.
}
