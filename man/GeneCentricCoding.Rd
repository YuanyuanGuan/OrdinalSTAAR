% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GeneCentricCoding.R
\name{GeneCentricCoding}
\alias{GeneCentricCoding}
\title{Gene-centric analysis of coding functional categories using OrdinalSTAAR}
\usage{
GeneCentricCoding(
  gene_name,
  genofile,
  objNull,
  genes_info,
  variant_type = NULL,
  categories = c("all", "all_ptv", "plof", "plof_ds", "ptv", "ptv_ds", "synonymous",
    "missense", "dmissense"),
  rare_maf_cutoff = 0.01,
  rare_num_cutoff = 2,
  geno_missing_cutoff = 1,
  geno_missing_imputation = c("mean", "minor"),
  min_maf_cutoff = 0,
  combine_ultra_rare = TRUE,
  ultra_rare_mac_cutoff = 20,
  QC_label = "annotation/filter",
  Annotation_dir = "annotation/info/FunctionalAnnotation",
  Annotation_name_catalog,
  Use_annotation_weights = TRUE,
  Annotation_name = NULL,
  use_SPA = NULL,
  SPA_filter = TRUE,
  SPA_filter_cutoff = 0.05,
  rm_long = TRUE,
  rm_long_cutoff = 3000,
  verbose = FALSE
)
}
\arguments{
\item{gene_name}{Character. The gene symbol to analyze.}

\item{genofile}{An opened annotated GDS (aGDS) object.}

\item{objNull}{An object from the ordinal null model, i.e. the output of
\code{OrdinalSTAAR_NullModel()}.}

\item{genes_info}{A matrix/data.frame with gene info; must include columns:
gene name (2nd col), start (3rd), end (4th). (Consistent with SurvSTAAR.)}

\item{variant_type}{Variant type to include: \code{"SNV"}, \code{"Indel"}, or \code{"variant"}
(both). Default \code{NULL} means follow downstream helpers' defaults.}

\item{categories}{One of
\code{c("all","all_ptv","plof","plof_ds","ptv","ptv_ds","synonymous","missense","dmissense")}.
Default \code{"all"}.}

\item{rare_maf_cutoff}{Max MAF for rare variants (default = 0.01).}

\item{rare_num_cutoff}{Minimum number of variants required per set (default = 2).}

\item{geno_missing_cutoff}{Missing-rate cutoff (default = 1, i.e., keep all).}

\item{geno_missing_imputation}{Imputation for missing genotypes:
\code{"mean"} or \code{"minor"} (default = \code{"mean"}).}

\item{min_maf_cutoff}{Minimum MAF for individual tests (default = 0).}

\item{combine_ultra_rare}{Logical; combine ultra-rare variants in SKAT & ACAT-V
under imbalance (default = TRUE).}

\item{ultra_rare_mac_cutoff}{Max MAC for ultra-rare variants (default = 20).}

\item{QC_label}{Channel name for QC label in aGDS (default = "annotation/filter").}

\item{Annotation_dir}{Channel prefix for annotations in aGDS
(default = "annotation/info/FunctionalAnnotation").}

\item{Annotation_name_catalog}{A data.frame mapping annotation names to their
aGDS channels.}

\item{Use_annotation_weights}{Logical; use annotations as weights (default = TRUE).}

\item{Annotation_name}{Vector of annotation names used in OrdinalSTAAR (default = NULL).}

\item{use_SPA}{Logical; whether to use SPA (default = \code{objNull$use_SPA} if present).}

\item{SPA_filter}{Logical; whether to recalibrate small p-values via SPA (default = TRUE).}

\item{SPA_filter_cutoff}{Numeric; threshold to trigger SPA (default = 0.05).}

\item{rm_long}{Logical; drop very long masks (default = TRUE).}

\item{rm_long_cutoff}{Integer; max variants allowed in a mask (default = 3000).}

\item{verbose}{Logical; print progress (default = FALSE).}
}
\value{
A list of results produced by the chosen category helper(s).
For \code{"all"}/\code{"all_ptv"}, this includes:
\itemize{
\item \code{gene_info}
\item \code{OrdinalSTAAR_O_all} (a named vector of omnibus p-values per category)
\item category-specific result lists (e.g., \code{plof}, \code{missense}, ...),
each containing the detailed OrdinalSTAAR omnibus outputs.
}
}
\description{
The \code{GeneCentricCoding} function takes in gene name, functional category,
an opened annotated GDS (aGDS) object, and the null model object to analyze
the association between an ordinal phenotype and coding functional categories
of a gene using the \strong{OrdinalSTAAR} procedure.
}
\details{
For each coding functional category, the OrdinalSTAAR-O p-value is derived from
an omnibus test that combines SKAT(1,25), SKAT(1,1), Burden(1,25), Burden(1,1),
ACAT-V(1,25), and ACAT-V(1,1), with p-values optionally weighted by annotations
via the Cauchy combination method.
}
